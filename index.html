<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">

	<title>Akka workshop - taming akka</title>
	<meta name="description" content="Akka workshop">
	<meta name="author" content="Krzysztof Romanowski">

	<meta name="apple-mobile-web-app-capable" content="yes"/>
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>

	<meta name="viewport"
	      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

	<link rel="stylesheet" href="css/reveal.css">
	<link rel="stylesheet" href="css/theme/black.css" id="theme">

	<!-- Code syntax highlighting -->
	<link rel="stylesheet" href="lib/css/zenburn.css">

	<link rel="stylesheet" href="css/ts.css">

	<!-- Printing and PDF exports -->
	<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
	</script>

	<!--[if lt IE 9]>
	<script src="lib/js/html5shiv.js"></script>
	<![endif]-->
</head>

<body>

<div class="reveal">

	<!-- Any section element inside of this container is displayed as a slide -->
	<div class="slides">

		<section data-markdown>
			<script type="text/template">
			## Tomasz Godzik


			<div class="lefty">
				<img class="ts-icon" src="imgs/gh.png" alt="Github: "> tgodzik

				<img class="ts-icon" src="imgs/twitter.png" alt="Twitter: "> @TomekGodzik

			</div>

			<img class="ts-icon" src="imgs/vl.png" alt="Virtus Lab"/>

			## Krzysztof Romanowski

			<div class="lefty">
				<img class="ts-icon" src="imgs/gh.png" alt="Github: "> romanowski

				<img class="ts-icon" src="imgs/twitter.png" alt="Twitter: "> @RomanowskiKr

			</div>

			<img class="ts-icon" src="imgs/vl.png" alt="Virtus Lab"/>

			</script>
		</section>

		<!-- ################################################################################################################ -->

		<section>
			<section data-markdown>
				<script type="text/template">
				## Akka Workshop

				### Remoting, supervision and clustering
				</script>
			</section>

			<section data-markdown>
				<script type="text/template">
				## Plan

				1. What is Akka?
				2. The little details.
				3. Dive into remoting.
				4. Parallelize your work.
				5. Handle your errors and supervise the minions.
				6. Terminate the straglers.
				7. Cluster!

				</script>
			</section>
        </section>
        <section>
            <section data-markdown>
                <script type="text/template">
				## What is Akka?

				### And what the hell is all this actor talk
                </script>
            </section>
            <section data-markdown>
                <script>
                    ## Actors can:
                </script>
            </section>
            <section data-markdown>
                <script>
                    ### Send a finite number of messages to other actors.
                </script>
            </section>
            <section data-markdown>
                <script>
                    ### Create a finite number of new actors.
                </script>
            </section>
            <section data-markdown>
                <script>
                    ### Designate the behavior to be used for the next message it receives.
                </script>
            </section>
            <section data-markdown>
                <script>
					### Fault tolerance in Akka.

					* Let it crash.
					* Multiple JVM.
					* Self healing.
                </script>
            </section>
            <section data-markdown>
                <script>
                    ### Code samples
                </script>
            </section>
            <section data-markdown>
                <script>
					### Creating actor
					```
					val system = ActorSystem("SystemName")
					val actorRef = system.actorOf(Props[Worker], "ActorName")
					```
                </script>
            </section>

            <section data-markdown>
                <script>
					### Sample actor
					```
					class MyActor extends Actor{
						def receive : Receive = {
							case message : String => println(message)
						}
					}
					```
                </script>
            </section>
            <section data-markdown>
                <script>
                    ### But most of what you need is in the starting script.
                </script>
            </section>
        </section>

        <section>
            <section data-markdown>
                <script type="text/template">
					## The little details

					### What to do?
                </script>
            </section>
			<section data-markdown>
				<script type="text/template">
				The server produces encrypted passwords that need to be decrypted in a client.

				We provided an encryption library, but it is far from perfect.
				</script>
			</section>

			<section data-markdown>
				<script type="text/template">
				To decrypt a password:
				```
				val decrypter = new Decrypter
				val prepared = decrypter.prepare(password)
				val decoded = decrypter.decode(prepared)
				val decrypted = decrypter.decrypt(decoded)
				```

				Beware, each operation is time consuming.
				</script>
			</section>

			<section data-markdown>
				<script type="text/template">
				Decrypter flaws:

				* There can be only a certain amount of decrypter instances in one JVM.

				* When one decrypter instance fails then *all* instances *silently* get corrupted (and produce wrong results).
				</script>
			</section>

			<section data-markdown>
				<script type="text/template">
				How to register?

				```scala
				remote ! Register(name)

				// remote send back a token, then

				remote ! SendMeEncryptedPassword(token)

				// remote sends back EncryptedPassword
				// decrypt password and then

				remote ! ValidateDecodedPassword(encrypted, decrypted)

				// remote sends back result:  PasswordCorrect or PasswordIncorrect
				```

				All messages are shown in the example code.
				</script>
			</section>

			<section data-markdown>
				<script type="text/template">
				### Basics
				```
				git clone https://github.com/VirtusLab/akka-workshop-client
				```

				```
				sbt run
				```
				### Leaderboard

				[headquarters:9000](http://headquarters:9000)

				Try to beat John Doe or us!
				</script>
			</section>

		</section>
		<!-- ################################################################################################################ -->

		<section>
			<section data-markdown>
				<script type="text/template">
				## Dive into remoting.

				Connect to a remote actor, decrypt passwords and send them back to us!

				Actor adress to use:
				```
				akka.tcp://application@headquarters:9552/user/PasswordsDistributor
				```
				</script>

			</section>

			<section data-markdown>
				<script type="text/template">
				Don't try to be the fastest or perfect.

				We just want to see your names on leaderboard!

				<br>
				```
				akka.tcp://application@headquarters:9552/user/PasswordsDistributor
				```
				</script>

			</section>

			<section data-markdown>
				<script type="text/template">
				Implement:

				* Login to the remote server (you will obtain unique token to sign all your requests)
				* Sending requests for new encrypted passwords to the central server
				* Receiving encrypted passwords
				* Decrypting given passwords using decryption library
				* Sending decrypted password back to the central server
				* Receiving information if password was properly decrypted

				<br>
				```
				akka.tcp://application@headquarters:9552/user/PasswordsDistributor
				```
				</script>
			</section>

            <section data-markdown>
                <script type="text/template">
					### Useful links

					* [http://doc.akka.io/docs/akka/2.4.3/scala/remoting.html](http://doc.akka.io/docs/akka/2.4.3/scala/remoting.html)

                </script>
            </section>

			<section data-markdown>
				<script type="text/template">
				If you stay behind:

				```
				git checkout akka-remoting
				```
				</script>
			</section>

		</section>

		<!-- ################################################################################################################ -->

		<section>

			<section data-markdown>
				<script type="text/template">
				## Parallelize your work.

				Go up on the leaderboard!
				</script>
			</section>

			<section data-markdown>
				<script type="text/template">
				Watch out! There can only be a limited number of Decryptor instances
				</script>
			</section>

			<section data-markdown>
				<script type="text/template">
				Implement:

				* supervisor actor responsible for spawning multiple workers, dispatching work, and communicating with a central server
				* multiple worker actors responsible for password decryption

				</script>
			</section>

			<section data-markdown>
				<script type="text/template">
				Don't try to be perfect.

				We just want to the passwords decrypted fast!
				</script>

			</section>

            <section data-markdown>
                <script type="text/template">
				### Creating router
				```
				val router: ActorRef =
					context.actorOf(RoundRobinPool(5).props(Props[Worker]))
				```
                </script>

            </section>
            <section data-markdown>
                <script type="text/template">
					### Useful links

					* [http://doc.akka.io/docs/akka/2.4.3/scala/routing.html](http://doc.akka.io/docs/akka/2.4.3/scala/routing.html)

                </script>
            </section>

			<section data-markdown>
				<script type="text/template">
				If you stay behind:

				```
				git checkout work-parallelization
				```
				</script>
			</section>
		</section>

		<!-- ################################################################################################################ -->

		<section>

			<section data-markdown>
				<script type="text/template">
				## Handle your errors and supervise the minions.

				</script>
			</section>

			<section data-markdown>
				<script type="text/template">
				Implement:

				* supervision strategy, so supervisor will be able to restart all workers in case of any error
				* retrying all broken computations
				</script>
			</section>
            <section data-markdown>
                <script type="text/template">
				### Creating supervision strategy
				```
				val restartingStrategy =
					AllForOneStrategy() { case _: Exception => Restart }
				```
                </script>

            </section>
			<section data-markdown>
				<script type="text/template">
				### Useful links

				* [http://doc.akka.io/docs/akka/2.4.3/general/supervision.html](http://doc.akka.io/docs/akka/2.4.3/general/supervision.html)

				</script>
			</section>
			<section data-markdown>
				<script type="text/template">
				If you stay behind:
				```
					git checkout error-handling-supervision
				```
				</script>
			</section>

		</section>
		<!-- ################################################################################################################ -->

		<section>

			<section data-markdown>
				<script type="text/template">
				## Terminate the straglers.

				</script>
			</section>

			<section data-markdown>
				<script type="text/template">
				[letitcrash.com/post/37854845601/little-pattern-message-based-loop](http://letitcrash.com/post/37854845601/little-pattern-message-based-loop)

				TL;DR:

				After each step in computation send result to yourself with all possible data to continue the task.
				</script>
			</section>



			<section data-markdown>
				<script type="text/template">
				Implement:

				* pattern which will allow us to stop computations in the middle of the work
				* minor tweaks for supervision strategy
				</script>
			</section>

			<section data-markdown>
				<script type="text/template">
				If you stay behind:

				```
				git checkout terminating-long-running-tasks
				```
				</script>
			</section>

		</section>

		<!-- ################################################################################################################ -->

		<section>

			<section data-markdown>
				<script type="text/template">
				## Cluster!

				</script>
			</section>

			<section data-markdown>
				<script type="text/template">
				Since we are limited inside one JVM maybe we should connect more of them to beat best times so far?
				</script>
			</section>



			<section data-markdown>
				<script type="text/template">
				To implement:

				* Cluster Singleton actor that will login to the central server and distribute work to all workers
				* Workers on each node connecting to that singleton actor
				* Changes to messages routing (varies depending on chosen strategy)
				</script>
			</section>
            <section data-markdown>
                <script type="text/template">
				### Useful links

				* [http://doc.akka.io/docs/akka/2.4.3/scala/cluster-usage.html](http://doc.akka.io/docs/akka/2.4.3/scala/cluster-usage.html)
				* [http://doc.akka.io/docs/akka/2.4.3/scala/cluster-singleton.html](http://doc.akka.io/docs/akka/2.4.3/scala/cluster-singleton.html)
                </script>
            </section>
			<section data-markdown>
				<script type="text/template">
					### Creating singleton
					```
					system.actorOf(ClusterSingletonManager.props(
						singletonProps = RequesterActor.props,
						terminationMessage = PoisonPill,
						settings = ClusterSingletonManagerSettings(system)),
						name = "consumer"
					)
					```
				</script>

			</section>
			<section data-markdown>
				<script type="text/template">
					### Creating singleton proxy
					```
					val singleton = system.actorOf(ClusterSingletonProxy.props(
						singletonManagerPath = "/user/consumer",
						settings = ClusterSingletonProxySettings(system)),
						name = "consumerProxy"
					)
					```
				</script>

			</section>
			<section data-markdown>
				<script type="text/template">
				If you stay behind:

				```
				git checkout clustering
				```
				</script>
			</section>
		</section>

		<!-- ################################################################################################################ -->

		<section data-markdown>
			<script type="text/template">
			## Tomasz Godzik


			<div class="lefty">
				<img class="ts-icon" src="imgs/gh.png" alt="Github: "> tgodzik

				<img class="ts-icon" src="imgs/twitter.png" alt="Twitter: "> @TomekGodzik

			</div>

			<img class="ts-icon" src="imgs/vl.png" alt="Virtus Lab"/>

			## Krzysztof Romanowski

			<div class="lefty">
				<img class="ts-icon" src="imgs/gh.png" alt="Github: "> romanowski

				<img class="ts-icon" src="imgs/twitter.png" alt="Twitter: "> @RomanowskiKr

			</div>

			<img class="ts-icon" src="imgs/vl.png" alt="Virtus Lab"/>

			</script>
		</section>

		<!-- ################################################################################################################ -->
	</div>

</div>

<script src="lib/js/head.min.js"></script>
<script src="js/reveal.js"></script>

<script>

			// Full list of configuration options available at:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// Optional reveal.js plugins
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});











</script>

</body>
</html>
adventurous
